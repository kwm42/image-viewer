# å›¾ç‰‡æŸ¥çœ‹å™¨åŠŸèƒ½è®¾è®¡æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº Next.js 13+ App Router çš„æœ¬åœ°å›¾ç‰‡æŸ¥çœ‹å™¨åº”ç”¨ï¼Œä½¿ç”¨ File System Access API è®¿é—®æœ¬åœ°æ–‡ä»¶ï¼Œé€šè¿‡ `file://` åè®®ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä½¿ç”¨ã€‚

### æ ¸å¿ƒç‰¹æ€§
- ğŸ—‚ï¸ **æ–‡ä»¶å¤¹æµè§ˆå™¨**ï¼šæ ‘çŠ¶ç›®å½•ç»“æ„ï¼Œæ”¯æŒå±•å¼€/æ”¶èµ·
- ğŸ–¼ï¸ **å›¾ç‰‡ç”»å»Š**ï¼šç½‘æ ¼/åˆ—è¡¨è§†å›¾ï¼Œæ”¯æŒé€’å½’æ˜¾ç¤ºå­æ–‡ä»¶å¤¹
- ğŸ” **å›¾ç‰‡é¢„è§ˆ**ï¼šå…¨å±å¼¹çª—ï¼Œæ”¯æŒç¼©æ”¾ã€æ—‹è½¬ã€å¹³ç§»
- ğŸ¬ **å¹»ç¯ç‰‡æ’­æ”¾**ï¼šè‡ªåŠ¨æ’­æ”¾ï¼Œå¯é…ç½®æ—¶é•¿å’Œè½¬æ¢åŠ¨ç”»

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **Next.js 13+**ï¼šä½¿ç”¨ App Router æ¨¡å¼
- **React 18**ï¼šUI æ¡†æ¶
- **TypeScript**ï¼šç±»å‹å®‰å…¨
- **Tailwind CSS**ï¼šæ ·å¼ç³»ç»Ÿ

### UI ç»„ä»¶åº“
- **Radix UI**ï¼šæ— æ ·å¼ã€å¯è®¿é—®çš„ UI åŸè¯­
  - `@radix-ui/react-dialog`ï¼šå›¾ç‰‡é¢„è§ˆå¼¹çª—
  - `@radix-ui/react-scroll-area`ï¼šæ»šåŠ¨åŒºåŸŸ
  - `@radix-ui/react-slider`ï¼šå¹»ç¯ç‰‡æ—¶é•¿æ§åˆ¶
  - `@radix-ui/react-select`ï¼šé€‰æ‹©å™¨ï¼ˆæ’åºã€åŠ¨ç”»ï¼‰
  - `@radix-ui/react-switch`ï¼šå¼€å…³ï¼ˆå¾ªç¯ã€éšæœºï¼‰
  - `@radix-ui/react-collapsible`ï¼šæ–‡ä»¶å¤¹å±•å¼€/æ”¶èµ·

### åŠ¨ç”»å’Œå·¥å…·
- **Framer Motion**ï¼šå¹»ç¯ç‰‡è½¬æ¢åŠ¨ç”»
- **File System Access API**ï¼šæµè§ˆå™¨åŸç”Ÿæ–‡ä»¶ç³»ç»Ÿè®¿é—®

### æ„å»ºå·¥å…·
- **pnpm**ï¼šåŒ…ç®¡ç†å™¨
- **Next.js Build**ï¼šé™æ€å¯¼å‡ºï¼ˆ`next build && next export`ï¼‰

---

## æ¶æ„è®¾è®¡

### ç›®å½•ç»“æ„

```
image-viewer/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ layout.tsx              # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx                # ä¸»é¡µé¢
â”‚   â””â”€â”€ globals.css             # å…¨å±€æ ·å¼
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ FolderTree/
â”‚   â”‚   â”œâ”€â”€ FolderTree.tsx      # æ–‡ä»¶å¤¹æ ‘ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ FolderNode.tsx      # å•ä¸ªæ–‡ä»¶å¤¹èŠ‚ç‚¹
â”‚   â”‚   â””â”€â”€ types.ts            # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ ImageGallery/
â”‚   â”‚   â”œâ”€â”€ ImageGallery.tsx    # å›¾ç‰‡ç”»å»Šï¼ˆç½‘æ ¼/åˆ—è¡¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ ImageCard.tsx       # å•å¼ å›¾ç‰‡å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ ImageGrid.tsx       # ç½‘æ ¼è§†å›¾
â”‚   â”‚   â”œâ”€â”€ ImageList.tsx       # åˆ—è¡¨è§†å›¾
â”‚   â”‚   â””â”€â”€ ViewModeToggle.tsx  # è§†å›¾åˆ‡æ¢
â”‚   â”œâ”€â”€ ImageViewer/
â”‚   â”‚   â”œâ”€â”€ ImageViewer.tsx     # å›¾ç‰‡é¢„è§ˆå¼¹çª—
â”‚   â”‚   â”œâ”€â”€ ImageControls.tsx   # æ§åˆ¶æ¡ï¼ˆç¼©æ”¾ã€æ—‹è½¬ï¼‰
â”‚   â”‚   â”œâ”€â”€ ImageNavigation.tsx # ä¸Šä¸€å¼ /ä¸‹ä¸€å¼ 
â”‚   â”‚   â””â”€â”€ ImageInfo.tsx       # å›¾ç‰‡ä¿¡æ¯æ˜¾ç¤º
â”‚   â”œâ”€â”€ Slideshow/
â”‚   â”‚   â”œâ”€â”€ Slideshow.tsx       # å¹»ç¯ç‰‡æ’­æ”¾å™¨
â”‚   â”‚   â”œâ”€â”€ SlideshowSettings.tsx  # è®¾ç½®é¢æ¿
â”‚   â”‚   â”œâ”€â”€ SlideshowControls.tsx  # æ’­æ”¾æ§åˆ¶
â”‚   â”‚   â””â”€â”€ transitions.ts      # è½¬æ¢åŠ¨ç”»é…ç½®
â”‚   â”œâ”€â”€ Toolbar/
â”‚   â”‚   â”œâ”€â”€ Toolbar.tsx         # é¡¶éƒ¨å·¥å…·æ 
â”‚   â”‚   â””â”€â”€ ToolbarButton.tsx   # å·¥å…·æ æŒ‰é’®
â”‚   â””â”€â”€ ui/
â”‚       â”œâ”€â”€ Button.tsx          # é€šç”¨æŒ‰é’®
â”‚       â”œâ”€â”€ IconButton.tsx      # å›¾æ ‡æŒ‰é’®
â”‚       â””â”€â”€ Separator.tsx       # åˆ†éš”çº¿
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useFileSystem.ts        # File System Access API å°è£…
â”‚   â”œâ”€â”€ useImageLoader.ts       # å›¾ç‰‡åŠ è½½ç®¡ç†
â”‚   â”œâ”€â”€ useKeyboardShortcuts.ts # é”®ç›˜å¿«æ·é”®
â”‚   â””â”€â”€ useLocalStorage.ts      # æœ¬åœ°å­˜å‚¨ï¼ˆè®°ä½è®¾ç½®ï¼‰
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ fileUtils.ts            # æ–‡ä»¶å¤„ç†å·¥å…·
â”‚   â”œâ”€â”€ imageUtils.ts           # å›¾ç‰‡å¤„ç†å·¥å…·
â”‚   â””â”€â”€ constants.ts            # å¸¸é‡å®šä¹‰
â”œâ”€â”€ types/
â”‚   â””â”€â”€ index.ts                # å…¨å±€ç±»å‹å®šä¹‰
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ åŠŸèƒ½è®¾è®¡æ–‡æ¡£.md          # æœ¬æ–‡æ¡£
â””â”€â”€ styles/
    â””â”€â”€ globals.css             # å…¨å±€ CSS
```

---

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. æ–‡ä»¶å¤¹æµè§ˆå™¨ (FolderTree)

#### åŠŸèƒ½éœ€æ±‚
- âœ… æ ‘çŠ¶ç»“æ„æ˜¾ç¤ºæ–‡ä»¶å¤¹å±‚çº§å…³ç³»
- âœ… ç‚¹å‡»æ–‡ä»¶å¤¹å±•å¼€/æ”¶èµ·å­æ–‡ä»¶å¤¹
- âœ… æ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶å¤¹å†…çš„å›¾ç‰‡æ•°é‡
- âœ… é«˜äº®æ˜¾ç¤ºå½“å‰é€‰ä¸­çš„æ–‡ä»¶å¤¹
- âœ… æ”¯æŒé”®ç›˜å¯¼èˆªï¼ˆä¸Šä¸‹é”®åˆ‡æ¢ï¼ŒEnter å±•å¼€ï¼‰
- âœ… æ”¯æŒé€’å½’æ‰«æå­æ–‡ä»¶å¤¹
- âœ… æ‡’åŠ è½½å­æ–‡ä»¶å¤¹ï¼ˆæŒ‰éœ€å±•å¼€æ—¶åŠ è½½ï¼‰

#### æ•°æ®ç»“æ„

```typescript
interface FolderNode {
  id: string;                    // å”¯ä¸€æ ‡è¯†
  name: string;                  // æ–‡ä»¶å¤¹åç§°
  handle: FileSystemDirectoryHandle;  // æ–‡ä»¶ç³»ç»Ÿå¥æŸ„
  path: string;                  // ç›¸å¯¹è·¯å¾„
  children: FolderNode[];        // å­æ–‡ä»¶å¤¹
  imageCount: number;            // å›¾ç‰‡æ•°é‡
  totalImageCount: number;       // åŒ…å«å­æ–‡ä»¶å¤¹çš„æ€»å›¾ç‰‡æ•°
  isExpanded: boolean;           // æ˜¯å¦å±•å¼€
  isLoaded: boolean;             // å­æ–‡ä»¶å¤¹æ˜¯å¦å·²åŠ è½½
  level: number;                 // å±‚çº§æ·±åº¦
}
```

#### ç»„ä»¶æ¥å£

```typescript
interface FolderTreeProps {
  rootFolder: FolderNode | null;
  selectedFolder: FolderNode | null;
  onFolderSelect: (folder: FolderNode) => void;
  onFolderToggle: (folder: FolderNode) => void;
}

interface FolderNodeProps {
  folder: FolderNode;
  isSelected: boolean;
  onSelect: () => void;
  onToggle: () => void;
  level: number;
}
```

#### UI è®¾è®¡
- ä½¿ç”¨ Radix UI `Collapsible` å®ç°å±•å¼€/æ”¶èµ·åŠ¨ç”»
- ä½¿ç”¨ `ChevronRightIcon` æŒ‡ç¤ºå±•å¼€çŠ¶æ€ï¼ˆå±•å¼€æ—¶å‘ä¸‹æ—‹è½¬ï¼‰
- ä½¿ç”¨ `FolderIcon`/`FolderOpenIcon` åŒºåˆ†çŠ¶æ€
- ç¼©è¿›å±‚çº§ï¼šæ¯å±‚ `padding-left: 1rem`
- æ‚¬åœæ•ˆæœï¼š`hover:bg-gray-100 dark:hover:bg-gray-800`
- é€‰ä¸­æ•ˆæœï¼š`bg-blue-100 dark:bg-blue-900`

---

### 2. å›¾ç‰‡ç”»å»Š (ImageGallery)

#### åŠŸèƒ½éœ€æ±‚
- âœ… **ç½‘æ ¼è§†å›¾**ï¼ˆé»˜è®¤ï¼‰ï¼šå“åº”å¼ç“¦ç‰‡å¸ƒå±€
- âœ… **åˆ—è¡¨è§†å›¾**ï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ˆæ–‡ä»¶åã€å¤§å°ã€å°ºå¯¸ã€æ—¥æœŸï¼‰
- âœ… **é€’å½’æ˜¾ç¤º**ï¼šå¯é€‰æ‹©æ˜¾ç¤ºå­æ–‡ä»¶å¤¹å›¾ç‰‡æˆ–ä»…å½“å‰æ–‡ä»¶å¤¹
- âœ… **æ‡’åŠ è½½**ï¼šä½¿ç”¨ Intersection Observer æ»šåŠ¨åŠ è½½
- âœ… **è™šæ‹Ÿæ»šåŠ¨**ï¼šå¤„ç†å¤§é‡å›¾ç‰‡æ—¶ä¼˜åŒ–æ€§èƒ½
- âœ… **æ’åºé€‰é¡¹**ï¼šæŒ‰åç§°ã€æ—¥æœŸã€å¤§å°ã€ç±»å‹æ’åº
- âœ… **è¿‡æ»¤åŠŸèƒ½**ï¼šæŒ‰æ–‡ä»¶åæœç´¢
- âœ… **å¤šé€‰æ¨¡å¼**ï¼šæ”¯æŒæ‰¹é‡æ“ä½œï¼ˆæœªæ¥æ‰©å±•ï¼‰

#### æ•°æ®ç»“æ„

```typescript
interface ImageFile {
  id: string;                    // å”¯ä¸€æ ‡è¯†
  name: string;                  // æ–‡ä»¶å
  handle: FileSystemFileHandle;  // æ–‡ä»¶å¥æŸ„
  path: string;                  // ç›¸å¯¹è·¯å¾„
  blob: Blob | null;             // æ–‡ä»¶æ•°æ®
  url: string;                   // Object URL
  thumbnail: string;             // ç¼©ç•¥å›¾ URL
  size: number;                  // æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
  width: number;                 // å›¾ç‰‡å®½åº¦
  height: number;                // å›¾ç‰‡é«˜åº¦
  type: string;                  // MIME ç±»å‹
  createdAt: Date;               // åˆ›å»ºæ—¶é—´
  modifiedAt: Date;              // ä¿®æ”¹æ—¶é—´
  folderPath: string;            // æ‰€å±æ–‡ä»¶å¤¹è·¯å¾„
}

type ViewMode = 'grid' | 'list';
type SortBy = 'name' | 'date' | 'size' | 'type';
type SortOrder = 'asc' | 'desc';

interface GallerySettings {
  viewMode: ViewMode;
  sortBy: SortBy;
  sortOrder: SortOrder;
  recursive: boolean;
  gridColumns: number;           // 2 | 3 | 4 | 6
}
```

#### ç»„ä»¶æ¥å£

```typescript
interface ImageGalleryProps {
  images: ImageFile[];
  settings: GallerySettings;
  onImageClick: (image: ImageFile, index: number) => void;
  onSettingsChange: (settings: Partial<GallerySettings>) => void;
}

interface ImageCardProps {
  image: ImageFile;
  viewMode: ViewMode;
  onClick: () => void;
  isSelected?: boolean;
}
```

#### ç½‘æ ¼è§†å›¾è®¾è®¡
```css
/* å“åº”å¼ç½‘æ ¼å¸ƒå±€ */
.image-grid {
  display: grid;
  gap: 1rem;
  
  /* 2 åˆ— */
  grid-template-columns: repeat(2, 1fr);
  
  /* 3 åˆ— - å¹³æ¿ */
  @media (min-width: 768px) {
    grid-template-columns: repeat(3, 1fr);
  }
  
  /* 4 åˆ— - æ¡Œé¢ */
  @media (min-width: 1024px) {
    grid-template-columns: repeat(4, 1fr);
  }
  
  /* 6 åˆ— - å¤§å± */
  @media (min-width: 1536px) {
    grid-template-columns: repeat(6, 1fr);
  }
}

/* å›¾ç‰‡å¡ç‰‡ */
.image-card {
  aspect-ratio: 1 / 1;
  overflow: hidden;
  border-radius: 0.5rem;
  cursor: pointer;
  transition: transform 0.2s;
}

.image-card:hover {
  transform: scale(1.05);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}
```

#### åˆ—è¡¨è§†å›¾è®¾è®¡
- æ¯è¡Œæ˜¾ç¤ºï¼šç¼©ç•¥å›¾ | æ–‡ä»¶å | å°ºå¯¸ | å¤§å° | ä¿®æ”¹æ—¥æœŸ
- å¯ç‚¹å‡»åˆ—æ ‡é¢˜æ’åº
- æ–‘é©¬çº¹èƒŒæ™¯ï¼ˆå¥‡å¶è¡Œä¸åŒé¢œè‰²ï¼‰

---

### 3. å›¾ç‰‡é¢„è§ˆå™¨ (ImageViewer)

#### åŠŸèƒ½éœ€æ±‚
- âœ… **å…¨å±å¼¹çª—**ï¼šä½¿ç”¨ Radix Dialog å®ç°
- âœ… **ç¼©æ”¾æ¨¡å¼**ï¼š
  - é€‚åº”çª—å£ï¼ˆFit to Windowï¼‰
  - å¡«å……çª—å£ï¼ˆFill Windowï¼‰
  - å®é™…å¤§å°ï¼ˆActual Sizeï¼‰
  - è‡ªå®šä¹‰ç¼©æ”¾ï¼ˆCustom Zoomï¼š10% - 500%ï¼‰
- âœ… **ç¼©æ”¾æ§åˆ¶**ï¼š
  - æ”¾å¤§ï¼ˆZoom Inï¼‰ï¼šæ¯æ¬¡ 25%
  - ç¼©å°ï¼ˆZoom Outï¼‰ï¼šæ¯æ¬¡ 25%
  - é‡ç½®ï¼ˆResetï¼‰ï¼šå›åˆ°é€‚åº”çª—å£
- âœ… **å¹³ç§»**ï¼šç¼©æ”¾æ—¶å¯æ‹–æ‹½å¹³ç§»
- âœ… **æ—‹è½¬**ï¼š90Â° å¢é‡æ—‹è½¬ï¼ˆ0Â°, 90Â°, 180Â°, 270Â°ï¼‰
- âœ… **å¯¼èˆª**ï¼šä¸Šä¸€å¼ /ä¸‹ä¸€å¼ ï¼Œå¾ªç¯åˆ‡æ¢
- âœ… **ä¿¡æ¯æ˜¾ç¤º**ï¼šæ–‡ä»¶åã€å°ºå¯¸ã€å¤§å°ã€å½“å‰ç´¢å¼•
- âœ… **é”®ç›˜å¿«æ·é”®**ï¼šå®Œæ•´æ”¯æŒ
- âœ… **è§¦æ§æ”¯æŒ**ï¼šåŒæŒ‡ç¼©æ”¾ã€æ‹–æ‹½å¹³ç§»ï¼ˆç§»åŠ¨ç«¯ï¼‰

#### æ•°æ®ç»“æ„

```typescript
type FitMode = 'contain' | 'cover' | 'actual' | 'custom';

interface ImageTransform {
  scale: number;                 // ç¼©æ”¾æ¯”ä¾‹ (0.1 - 5.0)
  rotation: number;              // æ—‹è½¬è§’åº¦ (0, 90, 180, 270)
  translateX: number;            // X è½´å¹³ç§»ï¼ˆåƒç´ ï¼‰
  translateY: number;            // Y è½´å¹³ç§»ï¼ˆåƒç´ ï¼‰
  fitMode: FitMode;              // ç¼©æ”¾æ¨¡å¼
}

interface ImageViewerState {
  isOpen: boolean;
  currentImage: ImageFile | null;
  currentIndex: number;
  images: ImageFile[];
  transform: ImageTransform;
  isLoading: boolean;
}
```

#### ç»„ä»¶æ¥å£

```typescript
interface ImageViewerProps {
  isOpen: boolean;
  image: ImageFile;
  images: ImageFile[];
  currentIndex: number;
  onClose: () => void;
  onNavigate: (direction: 'prev' | 'next') => void;
}

interface ImageControlsProps {
  transform: ImageTransform;
  onZoomIn: () => void;
  onZoomOut: () => void;
  onReset: () => void;
  onRotate: () => void;
  onFitModeChange: (mode: FitMode) => void;
}
```

#### UI å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [å…³é—­ X]                            1 / 42     â”‚
â”‚                                                 â”‚
â”‚                                                 â”‚
â”‚                                                 â”‚
â”‚                   [å›¾ç‰‡æ˜¾ç¤ºåŒºåŸŸ]                  â”‚
â”‚                                                 â”‚
â”‚                                                 â”‚
â”‚  [â—€ ä¸Šä¸€å¼ ]                      [ä¸‹ä¸€å¼  â–¶]      â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“· photo.jpg | 1920Ã—1080 | 2.3 MB        â”‚  â”‚
â”‚  â”‚ [âˆ’] 100% [+] [â†»] [é€‚åº”çª—å£ â–¾]            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ§åˆ¶æ¡è®¾è®¡
- æµ®åŠ¨åœ¨å›¾ç‰‡åº•éƒ¨
- åŠé€æ˜æ·±è‰²èƒŒæ™¯ï¼ˆ`backdrop-blur-md bg-black/50`ï¼‰
- å·¦ä¾§ï¼šå›¾ç‰‡ä¿¡æ¯
- å³ä¾§ï¼šç¼©æ”¾æ§åˆ¶æŒ‰é’®
- å±…ä¸­ï¼šé€‚åº”æ¨¡å¼é€‰æ‹©å™¨

---

### 4. å¹»ç¯ç‰‡æ’­æ”¾ (Slideshow)

#### åŠŸèƒ½éœ€æ±‚
- âœ… **è‡ªåŠ¨æ’­æ”¾**ï¼šæŒ‰é¡ºåºè‡ªåŠ¨åˆ‡æ¢å›¾ç‰‡
- âœ… **æ’­æ”¾æ§åˆ¶**ï¼šæ’­æ”¾ã€æš‚åœã€åœæ­¢
- âœ… **æ—¶é•¿è®¾ç½®**ï¼š1-30 ç§’å¯è°ƒï¼ˆé»˜è®¤ 3 ç§’ï¼‰
- âœ… **è¿›åº¦æ¡**ï¼šæ˜¾ç¤ºå½“å‰å›¾ç‰‡å‰©ä½™æ—¶é—´
- âœ… **è½¬æ¢åŠ¨ç”»**ï¼šå¤šç§è¿‡æ¸¡æ•ˆæœ
- âœ… **æ’­æ”¾æ¨¡å¼**ï¼š
  - é¡ºåºæ’­æ”¾
  - å¾ªç¯æ’­æ”¾
  - éšæœºæ’­æ”¾
- âœ… **å…¨å±æ¨¡å¼**ï¼šè‡ªåŠ¨è¿›å…¥å…¨å±
- âœ… **æš‚åœæ§åˆ¶**ï¼šé¼ æ ‡ç§»åŠ¨æ—¶æ˜¾ç¤ºæ§åˆ¶æ¡ï¼Œé™æ­¢æ—¶éšè—

#### è½¬æ¢åŠ¨ç”»ç±»å‹

```typescript
type TransitionType = 
  | 'none'        // æ— åŠ¨ç”»
  | 'fade'        // æ·¡å…¥æ·¡å‡º
  | 'slide'       // æ»‘åŠ¨
  | 'zoom'        // ç¼©æ”¾
  | 'flip'        // ç¿»è½¬
  | 'cube'        // ç«‹æ–¹ä½“æ—‹è½¬
  | 'dissolve';   // æº¶è§£

interface SlideshowSettings {
  interval: number;              // æ’­æ”¾é—´éš”ï¼ˆæ¯«ç§’ï¼‰
  transition: TransitionType;    // è½¬æ¢åŠ¨ç”»
  transitionDuration: number;    // åŠ¨ç”»æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰
  loop: boolean;                 // å¾ªç¯æ’­æ”¾
  random: boolean;               // éšæœºæ’­æ”¾
  autoFullscreen: boolean;       // è‡ªåŠ¨å…¨å±
  showInfo: boolean;             // æ˜¾ç¤ºå›¾ç‰‡ä¿¡æ¯
  showProgress: boolean;         // æ˜¾ç¤ºè¿›åº¦æ¡
}

interface SlideshowState {
  isPlaying: boolean;
  isPaused: boolean;
  currentIndex: number;
  progress: number;              // 0-100
  remainingTime: number;         // æ¯«ç§’
}
```

#### ç»„ä»¶æ¥å£

```typescript
interface SlideshowProps {
  images: ImageFile[];
  settings: SlideshowSettings;
  onSettingsChange: (settings: Partial<SlideshowSettings>) => void;
  onClose: () => void;
}

interface SlideshowControlsProps {
  state: SlideshowState;
  settings: SlideshowSettings;
  onPlay: () => void;
  onPause: () => void;
  onStop: () => void;
  onNext: () => void;
  onPrev: () => void;
  onOpenSettings: () => void;
}

interface SlideshowSettingsProps {
  settings: SlideshowSettings;
  onChange: (settings: Partial<SlideshowSettings>) => void;
}
```

#### åŠ¨ç”»å®ç°ï¼ˆFramer Motionï¼‰

```typescript
const transitions = {
  none: {
    initial: {},
    animate: {},
    exit: {}
  },
  
  fade: {
    initial: { opacity: 0 },
    animate: { opacity: 1 },
    exit: { opacity: 0 }
  },
  
  slide: {
    initial: { x: '100%', opacity: 0 },
    animate: { x: 0, opacity: 1 },
    exit: { x: '-100%', opacity: 0 }
  },
  
  zoom: {
    initial: { scale: 0.8, opacity: 0 },
    animate: { scale: 1, opacity: 1 },
    exit: { scale: 1.2, opacity: 0 }
  },
  
  flip: {
    initial: { rotateY: 90, opacity: 0 },
    animate: { rotateY: 0, opacity: 1 },
    exit: { rotateY: -90, opacity: 0 }
  }
};
```

#### è®¾ç½®é¢æ¿è®¾è®¡
ä½¿ç”¨ Radix Dialog å®ç°è®¾ç½®å¼¹çª—ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¹»ç¯ç‰‡è®¾ç½®                  [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ’­æ”¾æ—¶é•¿: [â”â”â—â”â”â”â”] 3 ç§’       â”‚
â”‚                                 â”‚
â”‚  è½¬æ¢åŠ¨ç”»: [æ·¡å…¥æ·¡å‡º â–¾]         â”‚
â”‚                                 â”‚
â”‚  åŠ¨ç”»æ—¶é•¿: [â”â—â”â”â”â”â”] 500ms      â”‚
â”‚                                 â”‚
â”‚  â–¡ å¾ªç¯æ’­æ”¾                     â”‚
â”‚  â–¡ éšæœºæ’­æ”¾                     â”‚
â”‚  â˜‘ è‡ªåŠ¨å…¨å±                     â”‚
â”‚  â˜‘ æ˜¾ç¤ºä¿¡æ¯                     â”‚
â”‚  â˜‘ æ˜¾ç¤ºè¿›åº¦                     â”‚
â”‚                                 â”‚
â”‚         [å–æ¶ˆ]  [ç¡®å®š]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File System Access API ä½¿ç”¨

### æ ¸å¿ƒ API å°è£…

```typescript
// hooks/useFileSystem.ts

export function useFileSystem() {
  // æ‰“å¼€æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†
  async function openFolder(): Promise<FileSystemDirectoryHandle | null> {
    try {
      const handle = await window.showDirectoryPicker({
        mode: 'read',
        startIn: 'pictures' // ä»å›¾ç‰‡æ–‡ä»¶å¤¹å¼€å§‹
      });
      return handle;
    } catch (err) {
      if (err.name === 'AbortError') {
        // ç”¨æˆ·å–æ¶ˆ
        return null;
      }
      throw err;
    }
  }

  // é€’å½’æ‰«ææ–‡ä»¶å¤¹
  async function scanFolder(
    dirHandle: FileSystemDirectoryHandle,
    path = ''
  ): Promise<{ folders: FolderNode[]; images: ImageFile[] }> {
    const folders: FolderNode[] = [];
    const images: ImageFile[] = [];

    for await (const entry of dirHandle.values()) {
      const entryPath = path ? `${path}/${entry.name}` : entry.name;

      if (entry.kind === 'directory') {
        const imageCount = await countImages(entry);
        folders.push({
          id: crypto.randomUUID(),
          name: entry.name,
          handle: entry,
          path: entryPath,
          children: [],
          imageCount,
          totalImageCount: imageCount,
          isExpanded: false,
          isLoaded: false,
          level: path.split('/').length
        });
      } else if (entry.kind === 'file') {
        if (isImageFile(entry.name)) {
          const file = await entry.getFile();
          images.push(await createImageFile(file, entry, entryPath));
        }
      }
    }

    return { folders, images };
  }

  // åˆ¤æ–­æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶
  function isImageFile(filename: string): boolean {
    const imageExtensions = [
      '.jpg', '.jpeg', '.png', '.gif', 
      '.webp', '.bmp', '.svg', '.avif'
    ];
    const ext = filename.toLowerCase().slice(filename.lastIndexOf('.'));
    return imageExtensions.includes(ext);
  }

  // åˆ›å»ºå›¾ç‰‡æ–‡ä»¶å¯¹è±¡
  async function createImageFile(
    file: File,
    handle: FileSystemFileHandle,
    path: string
  ): Promise<ImageFile> {
    const url = URL.createObjectURL(file);
    const dimensions = await getImageDimensions(url);

    return {
      id: crypto.randomUUID(),
      name: file.name,
      handle,
      path,
      blob: file,
      url,
      thumbnail: await createThumbnail(url, 300),
      size: file.size,
      width: dimensions.width,
      height: dimensions.height,
      type: file.type,
      createdAt: new Date(file.lastModified),
      modifiedAt: new Date(file.lastModified),
      folderPath: path.slice(0, path.lastIndexOf('/'))
    };
  }

  // è·å–å›¾ç‰‡å°ºå¯¸
  function getImageDimensions(url: string): Promise<{ width: number; height: number }> {
    return new Promise((resolve) => {
      const img = new Image();
      img.onload = () => resolve({ width: img.width, height: img.height });
      img.src = url;
    });
  }

  // ç”Ÿæˆç¼©ç•¥å›¾
  async function createThumbnail(url: string, maxSize: number): Promise<string> {
    return new Promise((resolve) => {
      const img = new Image();
      img.onload = () => {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d')!;

        const scale = Math.min(maxSize / img.width, maxSize / img.height);
        canvas.width = img.width * scale;
        canvas.height = img.height * scale;

        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        resolve(canvas.toDataURL('image/jpeg', 0.8));
      };
      img.src = url;
    });
  }

  // ç»Ÿè®¡æ–‡ä»¶å¤¹å›¾ç‰‡æ•°é‡
  async function countImages(dirHandle: FileSystemDirectoryHandle): Promise<number> {
    let count = 0;
    for await (const entry of dirHandle.values()) {
      if (entry.kind === 'file' && isImageFile(entry.name)) {
        count++;
      }
    }
    return count;
  }

  return {
    openFolder,
    scanFolder,
    isImageFile,
    createImageFile
  };
}
```

### æµè§ˆå™¨å…¼å®¹æ€§

| åŠŸèƒ½ | Chrome | Edge | Firefox | Safari |
|------|--------|------|---------|--------|
| File System Access API | âœ… 86+ | âœ… 86+ | âŒ | âŒ 15.2+ |
| showDirectoryPicker | âœ… | âœ… | âŒ | âŒ |

**é™çº§æ–¹æ¡ˆ**ï¼š
- ä¸æ”¯æŒçš„æµè§ˆå™¨ä½¿ç”¨ `<input type="file" webkitdirectory>`
- æç¤ºç”¨æˆ·ä½¿ç”¨ Chrome/Edge æµè§ˆå™¨

---

## æ•´ä½“é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ å›¾ç‰‡æŸ¥çœ‹å™¨                                    [è®¾ç½®] â”‚
â”‚  [æ‰“å¼€æ–‡ä»¶å¤¹] [è§†å›¾: ç½‘æ ¼ â–¾] [æ’åº: åç§° â–¾] [â˜‘ é€’å½’]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚                                          â”‚
â”‚  æ–‡ä»¶å¤¹æ ‘    â”‚         å›¾ç‰‡ç”»å»Š                         â”‚
â”‚             â”‚   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”             â”‚
â”‚  ğŸ“ æ ¹ç›®å½•   â”‚   â”‚ ğŸ–¼ï¸  â”‚ ğŸ–¼ï¸  â”‚ ğŸ–¼ï¸  â”‚ ğŸ–¼ï¸  â”‚             â”‚
â”‚  â”œâ”€ ğŸ“ 2023 â”‚   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  â”‚  â”œâ”€ ğŸ“ 01â”‚   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  â”‚  â””â”€ 42â”‚   â”‚ ğŸ–¼ï¸  â”‚ ğŸ–¼ï¸  â”‚ ğŸ–¼ï¸  â”‚ ğŸ–¼ï¸  â”‚             â”‚
â”‚  â”‚  â””â”€ ğŸ“ 02â”‚   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜             â”‚
â”‚  â””â”€ ğŸ“ 2024 â”‚                                          â”‚
â”‚     â””â”€ ğŸ“ 01â”‚   å…± 156 å¼ å›¾ç‰‡                          â”‚
â”‚             â”‚   [ğŸ” æœç´¢...]        [â–¶ï¸ å¹»ç¯ç‰‡æ’­æ”¾]    â”‚
â”‚             â”‚                                          â”‚
â”‚  å¯è°ƒæ•´å®½åº¦  â”‚                                          â”‚
â”‚     â†”       â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é”®ç›˜å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ | ä½œç”¨åŸŸ |
|--------|------|--------|
| `Ctrl/Cmd + O` | æ‰“å¼€æ–‡ä»¶å¤¹ | å…¨å±€ |
| `Space` | æ’­æ”¾/æš‚åœå¹»ç¯ç‰‡ | é¢„è§ˆ/å¹»ç¯ç‰‡ |
| `F11` / `F` | å…¨å±åˆ‡æ¢ | é¢„è§ˆ/å¹»ç¯ç‰‡ |
| `Esc` | å…³é—­é¢„è§ˆ/é€€å‡ºå…¨å± | é¢„è§ˆ/å¹»ç¯ç‰‡ |
| `â†` / `â†’` | ä¸Šä¸€å¼ /ä¸‹ä¸€å¼  | é¢„è§ˆ/å¹»ç¯ç‰‡ |
| `â†‘` / `â†“` | ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªæ–‡ä»¶å¤¹ | æ–‡ä»¶å¤¹æ ‘ |
| `Enter` | å±•å¼€/æ”¶èµ·æ–‡ä»¶å¤¹ | æ–‡ä»¶å¤¹æ ‘ |
| `+` / `=` | æ”¾å¤§ | é¢„è§ˆ |
| `-` | ç¼©å° | é¢„è§ˆ |
| `0` | é‡ç½®ç¼©æ”¾ | é¢„è§ˆ |
| `R` | æ—‹è½¬å›¾ç‰‡ | é¢„è§ˆ |
| `1` | é€‚åº”çª—å£ | é¢„è§ˆ |
| `2` | å®é™…å¤§å° | é¢„è§ˆ |
| `Ctrl/Cmd + G` | åˆ‡æ¢ç½‘æ ¼/åˆ—è¡¨è§†å›¾ | ç”»å»Š |
| `Ctrl/Cmd + F` | æœç´¢å›¾ç‰‡ | ç”»å»Š |

---

## æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. å›¾ç‰‡åŠ è½½ä¼˜åŒ–
- **æ‡’åŠ è½½**ï¼šä½¿ç”¨ Intersection Observer åªåŠ è½½å¯è§åŒºåŸŸå›¾ç‰‡
- **ç¼©ç•¥å›¾**ï¼šCanvas ç”Ÿæˆç¼©ç•¥å›¾ï¼Œå‡å°‘å†…å­˜å ç”¨
- **æ¸è¿›å¼åŠ è½½**ï¼šå…ˆæ˜¾ç¤ºä½è´¨é‡ç¼©ç•¥å›¾ï¼Œå†åŠ è½½é«˜æ¸…åŸå›¾
- **é¢„åŠ è½½**ï¼šé¢„è§ˆæ—¶æå‰åŠ è½½å‰å 3 å¼ å›¾ç‰‡

### 2. è™šæ‹Ÿæ»šåŠ¨
```typescript
// ä½¿ç”¨ react-window æˆ– react-virtual å®ç°
import { FixedSizeGrid } from 'react-window';

<FixedSizeGrid
  columnCount={4}
  columnWidth={300}
  height={800}
  rowCount={Math.ceil(images.length / 4)}
  rowHeight={300}
  width={1200}
>
  {({ columnIndex, rowIndex, style }) => {
    const index = rowIndex * 4 + columnIndex;
    const image = images[index];
    return <ImageCard key={image.id} image={image} style={style} />;
  }}
</FixedSizeGrid>
```

### 3. ç¼“å­˜ç­–ç•¥
```typescript
// ä½¿ç”¨ IndexedDB ç¼“å­˜ç¼©ç•¥å›¾
const thumbnailCache = new Map<string, string>();

async function getCachedThumbnail(imagePath: string): Promise<string | null> {
  // å…ˆæŸ¥å†…å­˜ç¼“å­˜
  if (thumbnailCache.has(imagePath)) {
    return thumbnailCache.get(imagePath)!;
  }

  // å†æŸ¥ IndexedDB
  const cached = await db.thumbnails.get(imagePath);
  if (cached) {
    thumbnailCache.set(imagePath, cached.data);
    return cached.data;
  }

  return null;
}

async function saveThumbnail(imagePath: string, thumbnail: string) {
  thumbnailCache.set(imagePath, thumbnail);
  await db.thumbnails.put({ path: imagePath, data: thumbnail });
}
```

### 4. å†…å­˜ç®¡ç†
```typescript
// åŠæ—¶é‡Šæ”¾ Object URL
function cleanupImage(image: ImageFile) {
  if (image.url) {
    URL.revokeObjectURL(image.url);
  }
  if (image.thumbnail) {
    URL.revokeObjectURL(image.thumbnail);
  }
}

// ç»„ä»¶å¸è½½æ—¶æ¸…ç†
useEffect(() => {
  return () => {
    images.forEach(cleanupImage);
  };
}, [images]);
```

---

## çŠ¶æ€ç®¡ç†

ä½¿ç”¨ React Context + Hooks è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼š

```typescript
// contexts/AppContext.tsx

interface AppState {
  // æ–‡ä»¶ç³»ç»Ÿ
  rootFolder: FolderNode | null;
  selectedFolder: FolderNode | null;
  allImages: ImageFile[];
  filteredImages: ImageFile[];

  // ç”»å»Šè®¾ç½®
  gallerySettings: GallerySettings;

  // é¢„è§ˆçŠ¶æ€
  viewerState: ImageViewerState;

  // å¹»ç¯ç‰‡çŠ¶æ€
  slideshowState: SlideshowState;
  slideshowSettings: SlideshowSettings;

  // UI çŠ¶æ€
  isLoading: boolean;
  error: string | null;
}

interface AppActions {
  openFolder: () => Promise<void>;
  selectFolder: (folder: FolderNode) => void;
  toggleFolder: (folder: FolderNode) => void;
  updateGallerySettings: (settings: Partial<GallerySettings>) => void;
  openImageViewer: (image: ImageFile, index: number) => void;
  closeImageViewer: () => void;
  navigateImage: (direction: 'prev' | 'next') => void;
  startSlideshow: () => void;
  stopSlideshow: () => void;
  updateSlideshowSettings: (settings: Partial<SlideshowSettings>) => void;
}

const AppContext = createContext<AppState & AppActions>(null!);

export function AppProvider({ children }: { children: React.ReactNode }) {
  const [state, setState] = useState<AppState>(initialState);
  
  // ... å®ç°å„ç§ actions
  
  return (
    <AppContext.Provider value={{ ...state, ...actions }}>
      {children}
    </AppContext.Provider>
  );
}

export const useApp = () => useContext(AppContext);
```

---

## æœ¬åœ°å­˜å‚¨ï¼ˆæŒä¹…åŒ–ï¼‰

ä½¿ç”¨ localStorage ä¿å­˜ç”¨æˆ·åå¥½è®¾ç½®ï¼š

```typescript
interface StoredPreferences {
  gallerySettings: GallerySettings;
  slideshowSettings: SlideshowSettings;
  lastOpenedFolder: string | null;  // æ–‡ä»¶å¤¹è·¯å¾„
  theme: 'light' | 'dark' | 'auto';
  language: 'zh-CN' | 'en-US';
}

// hooks/useLocalStorage.ts
export function useLocalStorage<T>(key: string, defaultValue: T) {
  const [value, setValue] = useState<T>(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : defaultValue;
    } catch {
      return defaultValue;
    }
  });

  useEffect(() => {
    try {
      window.localStorage.setItem(key, JSON.stringify(value));
    } catch (error) {
      console.error('Failed to save to localStorage:', error);
    }
  }, [key, value]);

  return [value, setValue] as const;
}
```

---

## æ„å»ºå’Œéƒ¨ç½²

### å¼€å‘æ¨¡å¼
```bash
pnpm dev
# è®¿é—® http://localhost:3000
```

### ç”Ÿäº§æ„å»º
```bash
# æ„å»ºé™æ€æ–‡ä»¶
pnpm build

# Next.js 13+ å¯¼å‡ºé™æ€ç«™ç‚¹
# next.config.js é…ç½®ï¼š
# output: 'export'

# æ„å»ºäº§ç‰©åœ¨ out/ ç›®å½•
```

### ä½¿ç”¨æ–¹å¼
```bash
# æ–¹å¼ 1: ç›´æ¥æ‰“å¼€ HTML æ–‡ä»¶
file:///path/to/out/index.html

# æ–¹å¼ 2: ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨
npx serve out

# æ–¹å¼ 3: æ‰“åŒ…æˆæ¡Œé¢åº”ç”¨ï¼ˆå¯é€‰ï¼‰
# ä½¿ç”¨ Tauri ç­‰è½»é‡çº§æ¡†æ¶
```

---

## æœªæ¥æ‰©å±•åŠŸèƒ½

### Phase 4 - é«˜çº§ç‰¹æ€§
- [ ] **å›¾ç‰‡ç¼–è¾‘**ï¼šè£å‰ªã€æ—‹è½¬ã€æ»¤é•œ
- [ ] **æ ‡ç­¾ç³»ç»Ÿ**ï¼šä¸ºå›¾ç‰‡æ·»åŠ æ ‡ç­¾å’Œæè¿°
- [ ] **æ”¶è—åŠŸèƒ½**ï¼šæ”¶è—å–œæ¬¢çš„å›¾ç‰‡
- [ ] **å¯¼å‡ºåŠŸèƒ½**ï¼šå¯¼å‡ºé€‰ä¸­å›¾ç‰‡åˆ°æ–°æ–‡ä»¶å¤¹
- [ ] **å¯¹æ¯”æ¨¡å¼**ï¼šå¹¶æ’å¯¹æ¯”ä¸¤å¼ å›¾ç‰‡
- [ ] **å…ƒæ•°æ®æ˜¾ç¤º**ï¼šEXIF ä¿¡æ¯ï¼ˆç›¸æœºå‹å·ã€æ‹æ‘„å‚æ•°ç­‰ï¼‰
- [ ] **åœ°å›¾è§†å›¾**ï¼šåŸºäº GPS ä¿¡æ¯åœ¨åœ°å›¾ä¸Šæ˜¾ç¤º
- [ ] **æ—¶é—´è½´è§†å›¾**ï¼šæŒ‰æ—¶é—´è½´æµè§ˆå›¾ç‰‡
- [ ] **äººè„¸è¯†åˆ«**ï¼šåŸºäºæµè§ˆå™¨ API çš„ç®€å•äººè„¸æ£€æµ‹
- [ ] **é‡å¤æ£€æµ‹**ï¼šæ‰¾å‡ºé‡å¤æˆ–ç›¸ä¼¼å›¾ç‰‡
- [ ] **æ‰¹é‡é‡å‘½å**ï¼šæ‰¹é‡ä¿®æ”¹æ–‡ä»¶å
- [ ] **æ‰“å°åŠŸèƒ½**ï¼šæ‰“å°å›¾ç‰‡æˆ–è”ç³»è¡¨

### æŠ€æœ¯æ”¹è¿›
- [ ] **PWA æ”¯æŒ**ï¼šç¦»çº¿å¯ç”¨ï¼Œæ·»åŠ åˆ°ä¸»å±å¹•
- [ ] **å›½é™…åŒ–**ï¼šå¤šè¯­è¨€æ”¯æŒï¼ˆä¸­æ–‡ã€è‹±æ–‡ï¼‰
- [ ] **ä¸»é¢˜ç³»ç»Ÿ**ï¼šäº®è‰²/æš—è‰²/è‡ªå®šä¹‰ä¸»é¢˜
- [ ] **æ— éšœç¢ä¼˜åŒ–**ï¼šå®Œæ•´çš„ ARIA æ”¯æŒå’Œé”®ç›˜å¯¼èˆª
- [ ] **æ€§èƒ½ç›‘æ§**ï¼šé›†æˆ Web Vitals ç›‘æ§
- [ ] **é”™è¯¯è¿½è¸ª**ï¼šSentry ç­‰é”™è¯¯è¿½è¸ªæœåŠ¡

---

## æŠ€æœ¯å€ºåŠ¡å’Œå·²çŸ¥é—®é¢˜

1. **File System Access API å…¼å®¹æ€§**
   - Firefox å’Œæ—§ç‰ˆ Safari ä¸æ”¯æŒ
   - éœ€è¦æä¾›é™çº§æ–¹æ¡ˆ

2. **å¤§é‡å›¾ç‰‡æ€§èƒ½**
   - è¶…è¿‡ 1000 å¼ å›¾ç‰‡æ—¶éœ€è¦ä¼˜åŒ–
   - è€ƒè™‘åˆ†é¡µæˆ–è™šæ‹Ÿæ»šåŠ¨

3. **å†…å­˜æ³„æ¼é£é™©**
   - Object URL éœ€è¦åŠæ—¶é‡Šæ”¾
   - éœ€è¦å®Œå–„çš„æ¸…ç†æœºåˆ¶

4. **ç§»åŠ¨ç«¯ä½“éªŒ**
   - è§¦æ§æ‰‹åŠ¿æ”¯æŒéœ€è¦å®Œå–„
   - å“åº”å¼å¸ƒå±€éœ€è¦ä¼˜åŒ–

---

## æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
```typescript
// ä½¿ç”¨ Jest + React Testing Library
describe('FolderTree', () => {
  it('should render folder nodes', () => {
    // ...
  });

  it('should toggle folder expansion', () => {
    // ...
  });
});
```

### E2E æµ‹è¯•
```typescript
// ä½¿ç”¨ Playwright
test('open folder and view images', async ({ page }) => {
  await page.goto('file:///path/to/index.html');
  await page.click('text=æ‰“å¼€æ–‡ä»¶å¤¹');
  // æ¨¡æ‹Ÿæ–‡ä»¶é€‰æ‹©...
  await expect(page.locator('.image-card')).toHaveCount(10);
});
```

---

## æ€»ç»“

æœ¬å›¾ç‰‡æŸ¥çœ‹å™¨é‡‡ç”¨ç°ä»£ Web æŠ€æœ¯æ ˆï¼Œåˆ©ç”¨ File System Access API å®ç°æœ¬åœ°æ–‡ä»¶è®¿é—®ï¼Œæ— éœ€åç«¯æœåŠ¡å™¨ã€‚é€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œæä¾›æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚

**æ ¸å¿ƒä¼˜åŠ¿ï¼š**
- âœ… çº¯å‰ç«¯åº”ç”¨ï¼Œæ— éœ€å®‰è£…
- âœ… ç›´æ¥é€šè¿‡æµè§ˆå™¨è®¿é—®æœ¬åœ°æ–‡ä»¶
- âœ… å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå„ç§å±å¹•å°ºå¯¸
- âœ… ä¸°å¯Œçš„åŠŸèƒ½å’Œè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ
- âœ… å¯æ‰©å±•çš„æ¶æ„ï¼Œæ˜“äºæ·»åŠ æ–°åŠŸèƒ½

**é€‚ç”¨åœºæ™¯ï¼š**
- æœ¬åœ°å›¾ç‰‡æµè§ˆå’Œç®¡ç†
- æ‘„å½±å¸ˆä½œå“é›†å±•ç¤º
- è®¾è®¡ç¨¿é¢„è§ˆå’Œå¯¹æ¯”
- å®¶åº­ç›¸å†Œæ•´ç†
